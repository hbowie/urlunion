<!-- #bbinclude "pspub_header.html" #pagetitle#="PSTextMerge Tutorial on Templates"--><!-- Start pspub_header.html --><!-- Beginning of an HTML file --><!-- pagetitle = Page Title --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head>	<title>PowerSurge Publishing -- PSTextMerge Tutorial on Templates</title>	<meta name="description" content="Shareware application capable of manipulating tab-delimited files, including the ability to merge tab-delimited data from a database or spreadsheet into an HTML template to create a finished Web page.">	<meta name="keywords" content="Java, Macintosh, software, PSTextMerge, TDF Czar, Web tools, Web merge, HTML merge, tab-delimited files, text sort, text merge, populate HTML tables">	<link rel=stylesheet href="../../../styles.css" type="text/css" 		title="PowerSurge Software Standard Style Sheet"></head><body bgcolor="#FFFFFF" link="#000066" alink="#993366" vlink="#663399" leftmargin=2 topmargin=2><a name="top"></a><table summary="Page Layout" border=0 width="100%" cellspacing=2 cellpadding=2><tr><td valign=top><table class=navTable summary="Navigation Buttons" border=0 width="100%" cellspacing=3 cellpadding=4><tr><td class=clear><a href="../../../index.html"><img src="../../../images/pstextmerge_128x128.gif" alt="PSTextMerge" width=128 height=128 border=0 align=bottom hspace=27 vspace=5></a><br clear=all></td></tr><tr><td class=navButton>  <a class=navLink href="../../../index.html">    Home  </a></td></tr><tr><td class=navButton>  <a class=navLink href="../../../downloads.html">    Downloads  </a></td></tr><tr><td class=navButton>  <a class=navLink href="../../../store.html">    Store  </a></td></tr><tr><td class=navButton>  <a class=navLink href="../../../support.html">    Support  </a></td></tr><tr><td class=navButton>  <a class=navLink href="../../../products.html">    Products  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=16 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge.html">    PSTextMerge  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/faq.html">    FAQ  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/workshop.html">    Workshop  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/examples.html">    Examples  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/tutorials.html">    Tutorials  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=48 height=1 border=0 align=left>    Templates</td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/opguide.html">    Operating Guide  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/trouble.html">    Troubleshooting  </a></td></tr><tr><td class=navButton><img src="../../../images/white_space.gif" alt="" width=32 height=1 border=0 align=left>  <a class=navLink href="../../../products/pstextmerge/versions.html">    Version History  </a></td></tr></table></td><td width=10 bgcolor="#FFFFFF"><img src="../../../images/white_space.gif" alt="" width=10 height=1 hspace=0 vspace=0 border=0 align=left></td><td valign=top><p class=crumbs><a href="../../../products.html">Products</a> | <a href="../../../products/pstextmerge.html">PSTextMerge</a> | <a href="../../../products/pstextmerge/tutorials.html">Tutorials</a></p><h1>PSTextMerge Tutorial on Templates</h1><!-- End pspub_header.html --><!-- end bbinclude --><h3>What's a Template File?</h3><p>A PSTextMerge Template file is a text file with special commands and variables embedded in it. The commands control how one or more output files are created. The variables are replaced with real data taken from an input data source &#8212; normally a tab-delimited file (possibly saved from a database table), or even an MS Excel spreadsheet. The remaining text, other than commands and variables, is written verbatim to the output file(s). In this sense, PSTextMerge works like a traditional mail-merge program, except you are merging your data into Web pages (or other text files) rather than letters. </p><h3>What's a Template Good For? </h3><p>Sometime you have rows and columns of data already defined, and you want to publish some or all of this data to the Web. Using a spreadsheet, database, or address book to store and maintain your data is a good strategy &#8212; after all, that's what these sorts of programs were designed for. And leaving them in this sort of format lets you use the data in other ways. You could even publish the data into multiple Web pages, each sorted differently, or with different selections of rows or columns.  </p><h3>Couldn't I Use Some Other Program? </h3><p>Yes. The spreadsheet or database program you are using may be capable of saving its data into a Web format. But typically these programs are rather rigid about formatting their Web pages, whereas PSTextMerge gives you total control over the design of your output. If you have your own Web server, with ASP, JSP or PHP, plus a relational database, then you can generate Web pages dynamically, merging the data from your database into your Web pages as your users request them. But not everyone has the resources for this kind of dynamic database publishing. Since PSTextMerge creates static HTML, the resulting Web pages can easily be published on any Web server or corporate intranet. And once these Web pages are posted to your server, you don't have to worry about them breaking because someone changed the format of your database, or updated your database software, or any one of numerous other things that can go wrong in a dynamic environment. </p><h3>Basic Template Commands</h3><p>A template command begins with a less than sign followed by a question mark, and ends with a question mark followed by a greater than sign. Template commands must always be on a line by themselves. </p><p>Every valid template file must contain a minimum of three commands. Let's look at the following, simple example. The three commands are in <span class=command>blue</span> lettering. </p><dl><dd><span class=command>&lt;?output "index.html"?&gt;</span><dd>&lt;html&gt;<dd>&lt;head&gt;<dd>&lt;title&gt;Sample 1&lt;/title&gt;<dd>&lt;/head&gt;<dd>&lt;body&gt;<dd><span class=command>&lt;?nextrec?&gt;</span><dd>&lt;p&gt;<span class=variable>=$artist$=</span> -- <span class=variable>=$cdtitle$=</span>&lt;/p&gt;<dd><span class=command>&lt;?loop?&gt;</span><dd>&lt;/body&gt;<dd>&lt;/html&gt;</dl><p>The <span class=command>output</span> command assigns a name to the output file that is to be created. In this case the file is in the same directory as the template, but a drive identifier and/or path can be supplied as well, in order to place the output file in a different location. </p><p>The <span class=command>nextrec</span> command needs no parameters, and simply indicates that the following lines should be repeated once for every row in the input data file. </p><p>The <span class=command>loop</span> command is the ending counterpart to the <span class=command>nextrec</span> command, indicating the end of the repeating block. Lines following the <span class=command>loop</span> command will be written out only once, after the end of the input data file has been encountered. </p><h3>Variables</h3><p>Variables are shown in <span class=variable>red</span> lettering in the above example. Notice that all of the variables appear within the <span class=command>nextrec</span> and <span class=command>loop</span> commands. This way the variables will assume different variables for each row in the input data. In this case, the input source contains one column called <span class=variable>artist</span> and another called <span class=variable>cdtitle</span>. Variable names are basically column headings from the input source &#8212; data taken from the first row of the table. Case, spacing and punctuation are insignificant, so the column heading in your table could be "CD Title", and the corresponding variable identifier in your template file could be "<span class=variable>cdtitle</span>", "<span class=variable>CD-Title</span>" or "<span class=variable>cd_title</span>" &#8212; all will work equally well. </p><p>There's a lot you can do with templates using nothing more than the information given above. But PSTextMerge offers you lots of other options, so read on. </p><h3>Creating One Page per Row</h3><p>If you have a lot of information in each row of your table, then you may want to create one entire Web page per row. This can be easily done, using nothing more than the features already described above. Simply put the <span class=command>nextrec</span> command on the first line of your template file, and move the <span class=command>loop</span> command to the last line. Now place the <span class=command>output</span> command on the second line of your template, and use a variable as part of your file name. Now each new data row will cause a separate output file to be written. </p><h3>Grouping Your Data</h3><p>Many times your data will fall into natural groupings. For example, you may have multiple CDs for the same <span class=variable>artist</span>. You might also have a genre or <span class=variable>category</span> defined for each CD. So let's say that you sort your data, first by <span class=variable>category</span>, and then by <span class=variable>artist</span> (you can do this within PSTextMerge, if you like). And since you will have many CDs for the same <span class=variable>category</span>, and often multiple CDs for the same <span class=variable>artist</span>, you may want to present this information in a heading, rather than repeating it for each CD. This can be easily done with PSTextMerge's group commands. Let's look at the following example.</p><dl><dd><span class=command>&lt;?output "index.html"?&gt;</span><dd>&lt;html&gt;<dd>&lt;head&gt;<dd>&lt;title&gt;Sample 2&lt;/title&gt;<dd>&lt;/head&gt;<dd>&lt;body&gt;<dd><span class=command>&lt;?nextrec?&gt;</span><dd><span class=command>&lt;?definegroup 1 "=$category$="?&gt;</span><dd><span class=command>&lt;?definegroup 2 "=$artist$="?&gt;</span><dd><span class=command>&lt;?ifnewgroup 1?&gt;</span><dd>&lt;h1&gt;<span class=variable>=$category$=</span>&lt;/h1&gt;<dd><span class=command>&lt;?ifnewgroup 2?&gt;</span><dd>&lt;h2&gt;<span class=variable>=$artist$=</span>&lt;/h2&gt;<dd><span class=command>&lt;?endif?&gt;</span><dd>&lt;p&gt;<span class=variable>=$cdtitle$=</span>&lt;/p&gt;<dd><span class=command>&lt;?loop?&gt;</span><dd>&lt;/body&gt;<dd>&lt;/html&gt;</dl><p>We have two <span class=command>definegroup</span> commands. <span class=variable>Category</span> is defined as group 1, since it is the first field we sorted by. The variables that define the group follow the group numbers on each <span class=command>definegroup</span> command line, and are enclosed in double quotation marks.  </p><p>Then we have two <span class=command>ifnewgroup</span> commands. Whenever the group variable changes, it will trigger the <span class=command>ifnewgroup</span> commands to be true, and will cause the following lines to be included in the output for that data row. In addition, higher-level breaks will automatically trigger lower-level breaks. In this case, that means that a change in category will always force a change in artist as well. The overall result in this case is that a level 1 heading will be displayed each time a new <span class=variable>category</span> is begun, and a level 2 heading will be displayed each time a new <span class=variable>artist</span> is encountered. The lines to be included following an <span class=command>ifnewgroup</span> command must be terminated by another group command, or by an explicit <span class=command>endif</span> command. </p><p>Although we don't use it in this example, there is also an <span class=command>ifendgroup</span> command that allows you to generate output at the end of a group break. This could be used to close a list, or end a table row, as two examples.</p><p>By the way, the <span class=command>ifchange</span> command was an earlier attempt to provide similar functionality. It combines the <span class=command>definegroup</span> and <span class=command>ifnewgroup</span> functions into a single command, but only allows one key field to be defined. It can be used as well if you have only one group, but the group commands generally provide more flexibility and control. </p><h3>Other Conditional Processing</h3><p>For other conditional processing, PSTextMerge provides a more general <span class=command>if</span> command. The simplest form the command takes is to simply include one variable after the command, as in the following example. </p><dl><dd><span class=command>&lt;?if "=$rating$="?&gt;</span><dd>&lt;p&gt;Rating: <span class=variable>=$rating$=</span>&lt;/p&gt;<dd><span class=command>&lt;?endif?&gt;</span><dd></dl><p>In this form, the command simply tests to see if the variable has a non-blank value. This is a convenient way to skip displaying some surrounding text if the variable itself is blank, as in the example above. Again, the conditional text must be terminated with an <span class=command>endif</span> command.</p><p>The expanded form of the <span class=command>if</span> command allows you to specify two values and a comparison operator. Either or both of the values can be variables. Let's look at the following example. </p><dl><dd><span class=command>&lt;?if "=$rating$=" >= 3?&gt;</span><dd>&lt;p&gt;Rating: <span class=variable>=$rating$=</span> -- Preferred&lt;/p&gt;<dd><span class=command>&lt;?endif?&gt;</span><dd></dl><p>In this example, we check to see if our <span class=variable>rating</span> of the CD is greater than or equal to 3. If it is, then you might want to print a special comment or image.  <h3>Counters</h3><p>From time to time it is handy to have some sort of counter available. For example, if laying out text in a table, you might use a counter to start a new table cell after a certain number of lines. Let's look at the following example. </p><dl><dd>&lt;table&gt;<dd>&lt;tr&gt;<dd>&lt;td&gt;<dd><span class=command>&lt;?set linect = 0?&gt;</span><dd><span class=command>&lt;?nextrec?&gt;</span><dd><span class=command>&lt;?if =$linect$= &gt; 10?&gt;</span><dd>&lt;/td&gt;<dd>&lt;td&gt;<dd><span class=command>&lt;?set linect = 0?&gt;</span><dd><span class=command>&lt;?endif?&gt;</span><dd><span class=variable>=$cdtitle$=</span> &lt;br&gt;<dd><span class=command>&lt;?set linect + 1?&gt;</span><dd><span class=command>&lt;?loop?&gt;</span><dd>&lt;/td&gt;<dd>&lt;/tr&gt;<dd>&lt;/table&gt;</dl><p>So what have we done here? The <span class=command>set</span> command can define a global variable, and increment or reset its value. Here we define a global variable called "<span class=variable>linect</span>" to maintain the number of lines we have included in a table cell. We set the value to zero at the beginning of our processing, and increment it by one each time we add a line to the current table cell. When we have included more than ten lines, we end the current table cell, start a new one and reset our counter. Very handy! </p><h3>Variable Modifiers</h3><p>PSTextMerge provides a few different ways to control the way variables appear in the output. By placing an ampersand after a variable, following characters will be treated as variable modifiers. The letters "u" or "l" will convert the variable to all upper- or lower-case, respectively. One or more digits will be interpreted as the maximum number of characters to display, truncating the variable if it is longer. And a punctuation character will be interpreted as a list separator. By using the same list separator on consecutive variables within a list, the separators will be used to separate non-blank occurrences of the variables. For example, if you have three variables, <span class=variable>keyword1</span>, <span class=variable>keyword2</span> and <span class=variable>keyword3</span>, with the first set to "warm", the second blank and the third set to "vibrant", then formatting your line like this:<dl><dd><span class=variable>=$keyword1$=</span>, <span class=variable>=$keyword2$=</span>, <span class=variable>=$keyword3$=</span>;</dl><p>would result in output like this:</p><dl><dd>warm, , vibrant</dl><p>On the other hand, formatting your template line as follows: </p><dl><dd><span class=variable>=$keyword1&,$=</span> <span class=variable>=$keyword2&,$=</span> <span class=variable>=$keyword3&,$=</span></dl><p>would result in the desired output: </p><dl><dd>warm, vibrant</dl><p>Note that you must include the list separator on all elements of the list, including the last. </p><h3>Using Other Delimiters</h3><p>There is one last command that we haven't talked about yet. This is the <span class=command>delims</span> command. You can use it to change the normal PSTextMerge delimiters to any other character combinations you want. The following line would change the default delimiters. </p><dl><dd><span class=command>&lt;?delims &lt;$ $&gt; &lt;@ @&gt; %&gt;&gt</span>;<dd><span class=command>&lt;$output "index.html"$&gt;</span></dl><p>The <span class=command>delims</span> command would normally be the first line in a file. This first line would use the default delimiters, but following lines would use whatever delimiters were set by the first line. The <span class=command>delims</span> command can set from one to five delimiters, in the following sequence: command start, command end, variable start, variable end, and variable modifiers start. </p><p>Normally, overriding the default delimiters would be optional and merely a matter of personal taste. However there is one case where new delimiters would be required. PSTextMerge can optionally create a data dictionary file. This is itself a tab-delimited file, with one row for each column in the primary data source. It is possible to create a meta-template file, in which the output to be written without change would include normal template commands and variables. In this case, the meta-template file would need to use a <span class=command>delims</span> command to override the normal delimiters, so that they would be written out unchanged. The meta-template file would then read the data dictionary, and use it to format a template file. This can be useful if each row of your data source contains many columns, and you want to format their display all similarly, since the meta-template can save you the hand-coding of the template. </p><!-- #bbinclude "pspub_footer.html" --><!-- Start pspub_footer.html --><p>&nbsp;</p><table width="100%" border=0 cellspacing=0 cellpadding=0><tr><td class=middle><a href="../../../index.html">Home</a> |<a href="../../../downloads.html">Downloads</a> |<a href="../../../store.html">Store</a> |<a href="../../../support.html">Support</a> |<a href="../../../products.html">Products</a> </td><td class=right><a href="#top"><img src="../../../images/top.gif" alt="" width=50 height=28 hspace=0 vspace=0 border=0 align=left></a></td></tr></table><p class=small>Copyright &copy; 1999-2007 Herb Bowie &bull;All rights reserved &bull; E-mail: <script type="text/javascript"><!--document.write('<a href="mailto:' + 'support@' + 'powersurgepub.com' + '">' + 'support@' + 'powersurgepub.com' + '<\/a>');// --></script></p><p class=small>http://www.powersurgepub.com/ &bull;template.html &bull; Revised: 8/14/05</p></td></tr></table></body></html><!-- End pspub_footer.html --><!-- end bbinclude -->